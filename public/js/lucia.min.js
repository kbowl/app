var Lucia=function(){"use strict";const e="l-";var t;!function(e){e["@"]="on",e[":"]="bind"}(t||(t={}));const n=e=>new RegExp(`\\b${e}\\b`,"gim"),s=e=>e.replace(/\s+/gim," ").trim(),i=(e,t)=>e[t],o=(e,t,n)=>e[t]=n,r=e=>[...new Set(e)],l=(e,t,n)=>{let s=`with($state){${null==n||n?`return ${e}`:e}}`;return(i,o)=>{try{const[r,l]=[Object.keys(i),Object.values(i)],c=e.replace(/(\[\d+\])|(\$state\.)|(\(\))|;*/gim,""),a=n?r.indexOf(c):-1;if(-1!==a)return((e,t,n)=>{const s=t[n],i=/\[(\d+)\]/gim.exec(e);return i&&i[1]&&s instanceof Array&&!isNaN(i[1])?s[Number(i[1])]:e.endsWith("()")?s():s})(e,l,a);{const e=(e,n,s=!0)=>{const i=new CustomEvent(e,n);(s?document:t||document).dispatchEvent(i)};return new Function("$state","$el","$emit","$event",s)(i,t,e,o)}}catch(n){console.warn(`Lucia Error: "${n}"\n\nExpression: "${e}"\nElement:`,t)}}},c=e=>e.hasAttribute("l-for"),a=(e,t)=>{const[s,i]=u(e,t),o=Object.keys(s).length>0,r=Object.values(s).some((({value:e})=>Object.keys(t).some((t=>n(t).test(e)))));return o?{el:e,deps:i,directives:s,type:r?1:0}:null},u=(s,c={})=>{const a={},u=[];for(const{name:d,value:p}of s.attributes){const f="l-state"===d,m=d.startsWith(e),v=Object.keys(t).some((e=>d.startsWith(e)));if(f||!m&&!v)continue;const h=[],_=Object.keys(c);let b=!0;const g=_.filter((e=>{const t=n(e).test(String(p));if("function"==typeof c[e]&&t){const t=_.filter((t=>n(t).test(String(c[e]))));h.push(...t)}return t}));/on|@/gim.test(d)&&(b=!1),d.includes("for")&&void 0===i(s,"__l_for_template")&&(o(s,"__l_for_template",String(s.innerHTML).trim()),b=!1);const y=r([...g,...h]);u.push(...y);const E={compute:l(p,s,b),deps:y,value:p};a[m?d.slice(e.length):`${t[d[0]]}:${d.slice(1)}`]=E}return[a,r(u)]},d=(e,t=!1,n=!1)=>{const s=[],i=c(e),o=!!(r=e).parentElement&&r.parentElement.hasAttribute("l-for");var r;if(!t&&(i||o))return s;if(n||t&&i||s.push(e),t||!i&&!o)for(const n of e.childNodes)if(n.nodeType===Node.ELEMENT_NODE)if(!t&&c(n))s.push(n);else{if(n.hasAttribute("l-state"))continue;s.push(...d(n,t))}return s},p=(e,n={},s=!1)=>{if(!e)throw new Error("Please provide a HTMLElement");const o=[],r=void 0!==i(e,"__l")&&c(e),l=d(e,r,s);for(const e of l)if(new RegExp(`(l-|${Object.keys(t).join("|")})\\w+`,"gim").test(e.outerHTML)){const t=a(e,n);t&&o.push(t)}return o},f=(e,t,n={},s=[])=>{const i=[],o=Object.keys(t);for(let r=0;r<e.length;r++){const l=e[r],c=0===l.type;c&&i.push(r);if(s.some((e=>l.deps.includes(e)))||c)for(const[e,i]of Object.entries(l.directives)){const r=e.split(/:|\./)[0];if(!o.includes(r.toUpperCase()))continue;const a=s.some((e=>i.deps.includes(e))),u=0===Object.keys(i.deps).length;if(a||c||u){const s={el:l.el,name:e,data:i,node:l,state:n};h(s,t),u&&delete l.directives[e]}}}for(const t of i)e.splice(t,1)},m=(e,t,n,s)=>{const i=[];for(const t of e)i.push(...t.deps);const o=r([...t,...i]);n.deps=o,n.directives[s].deps=o},v={BIND:({el:e,name:t,data:n,state:i})=>{switch(t.split(":")[1]){case"class":const o=n.compute(i);if("string"==typeof o)return e.setAttribute("class",s(`${e.className} ${o}`));if(o instanceof Array)return e.setAttribute("class",s(`${e.className} ${o.join(" ")}`));{const t=[];for(const e in o)o[e]&&t.push(e);const n=new RegExp(`\\b${Object.keys(o).join("|")}\\b`,"gim"),i=e.className.replace(n,"");return t.length>0?e.setAttribute("class",s(`${i} ${t.join(" ")}`)):s(e.className).length>0?e.setAttribute("class",s(i)):e.removeAttribute("class")}case"style":const r=n.compute(i);e.removeAttribute("style");for(const t in r)e.style[t]=r[t];break;default:const l=n.compute(i);if("object"==typeof l&&null!==l)for(const t in l)l[t]?e.setAttribute(t,l[t]):e.removeAttribute(t);else l?e.setAttribute(t.split(":")[1],l):e.removeAttribute(t.split(":")[1])}},HTML:({el:e,data:t,state:n,node:s})=>{var r;s=s;const l=i(e,"__l");e.innerHTML=null!==(r=t.compute(n))&&void 0!==r?r:t.value;const c=p(e,n,!0);l||m(c,t.deps,s,"html"),f(c,v,n,t.deps),o(e,"__l",!0)},IF:({el:e,data:t,state:n,node:s})=>{var r,l;s=s;const c=!!t.compute(n);if(!i(s.el,"__l_if_template")){const n=document.createElement("template");o(n,"__l_if_template",!0),n.content.appendChild(e.cloneNode(!0)),n.setAttribute("l-if",t.value),e.replaceWith(n),s.el=n}const a=i(s.el,"__l_has_inserted");if(!c&&a)null===(r=s.el.nextElementSibling)||void 0===r||r.remove(),o(s.el,"__l_has_inserted",!1);else if(c){if(!a){const e=s.el.content.cloneNode(!0);null===(l=s.el.parentElement)||void 0===l||l.insertBefore(e,s.el.nextElementSibling),o(s.el,"__l_has_inserted",!0)}const e=s.el.nextElementSibling;e.removeAttribute("l-if");const r=p(e,n);i(e,"__l")||m(r,t.deps,s,"if"),o(e,"__l",!0),f(r,v,n,s.deps)}},MODEL:({el:e,name:t,data:n,state:s})=>{const r=e,l=s[n.value],c="checkbox"===r.type?"checked":"value";if(r[c]!==String(l)&&(r[c]=l),!i(r,"__l_model_registered")){const e=t.split(".")[1],i=()=>((e,t,n,s)=>{"checkbox"===e.type&&(e.value=String(e.checked));const i="number"==typeof t&&!isNaN(e.value),o="boolean"==typeof t&&("true"===e.value||"false"===e.value),r=null==t&&("null"===e.value||"undefined"===e.value);let l;return l=i?parseFloat(e.value):o?"true"===e.value:r?"null"===e.value?null:void 0:String(e.value),s[n.value]=l,l})(r,l,n,s);r.addEventListener("debounce"===e?"change":"input",i),o(r,"__l_model_registered",!0)}},ON:({el:e,name:t,data:n,state:s})=>{const r={};if(i(e,"__l_on_registered"))return;const[l,c]=t.split("."),a=l.split(":")[1],u=c||null,d=["outside","global"].includes(String(u))?document:e;r.once="once"===u,r.passive="passive"===u,d.addEventListener(a,(t=>{if("prevent"===u&&t.preventDefault(),"stop"===u&&t.stopPropagation(),"outside"===u){if(e.contains(t.target))return;if(e.offsetWidth<1&&e.offsetHeight<1)return}n.compute(s,t)}),r),o(d,"__l_on_registered",!0)},TEXT:({el:e,data:t,state:n})=>{var s;e.textContent=null!==(s=t.compute(n))&&void 0!==s?s:t.value},FOR:({el:e,data:t,state:s,node:r})=>{r=r;const l=i(e,"__l");o(e,"__l",!0);const[c,a]=t.value.split(/\s+(?:in|of)\s+/gim),[u,d]=null==c?void 0:c.trim().replace(/\(|\)/gim,"").split(","),h=s[null==a?void 0:a.trim()],_=p(e,s);let b=i(e,"__l_for_template");e.innerHTML.trim()===b&&(e.innerHTML="");const g=(null==h?void 0:h.length)-e.children.length;if(0===(null==h?void 0:h.length))e.innerHTML="";else if(0!==g)for(let t=Math.abs(g);t>0;t--)if(g<0)e.removeChild(e.lastChild);else{const s=b.startsWith("<th")?"thead":b.startsWith("<td")||b.startsWith("<tr")?"tbody":"div",i=document.createElement(s);let o=b;u&&(o=o.replace(n(`this\\.${u.trim()}`),`${a}[${h.length-t}]`)),d&&(o=o.replace(n(`this\\.${d.trim()}`),String(h.length-t))),i.innerHTML=o,e.appendChild(i.firstElementChild)}l||m(_,t.deps,r,"for"),f(l?_:p(e,s),v,s,r.deps)}},h=(e,t)=>{t[e.name.split(/:|\./gim)[0].toUpperCase()](e)},_=(e,t)=>{const n={get:(e,t)=>"object"==typeof e[t]&&null!==e[t]?new Proxy(e[t],n):e[t],set(n,s,i){if("function"==typeof e[s])return!1;const o=!isNaN(Number(s))||"length"===s;let r=[];return r=n instanceof Array&&o?Object.keys(e).filter((t=>{return s=e[t],i=n,s instanceof Array&&i instanceof Array&&s.length===i.length&&s.every(((e,t)=>e===i[t]));var s,i})):Object.keys(e).some((e=>void 0===n[e]))?Object.keys(e).filter((t=>"object"==typeof e[t])):[s],n[s]=i,t(r),!0}};return Proxy.revocable(Object.seal(e),n)};class b{constructor(e={}){this.state=e,this.directives={}}mount(e){const t="string"==typeof e?document.querySelector(e):e;return this.ast=p(t,this.state),this.state=_(this.state,this.render.bind(this)).proxy,this.directives={...this.directives,...v},this.render(),o(t,"__l",this),this.state}directive(e,t){this.directives[e.toUpperCase()]=t}render(e=Object.keys(this.state)){f(this.ast,v,this.state,e)}}const g=e=>new b(e),y=(e=document)=>{const t="l-state",n="l-mask",s=[...e.querySelectorAll("[l-state]")].filter((e=>void 0===i(e,"__l")));for(let e of s){const s=e.getAttribute(t),i=e.getAttribute("l-init");e.getAttribute(n)&&e.removeAttribute(n);const o=l(`${s||"{}"}`,e,!0)({});g(o).mount(e);const r=i?l(`${i}`,e,!0):void 0;r&&r(o)}};var E=Object.freeze({__proto__:null,component:g,compile:p,render:f,reactive:_,directives:v,computeExpression:l,init:y});const $=()=>y(),j=async()=>{await new Promise((e=>{"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()})),$(),document.addEventListener("turbolinks:load",$),document.addEventListener("turbo:load",$)};return window.__l?window.__l((()=>j())):j(),E}();
