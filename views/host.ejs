<!DOCTYPE html>
<html lang="en">
  <%- include('./partials/head.ejs') %>

  <body>
    <div id="app">
      <%- include('./partials/header.ejs') %>
      <h1>Room Code: <kbd l-text="id"></kbd></h1>
      <details open>
        <summary>Leaderboard</summary>
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Score</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody l-for="team in leaderboard">
            <tr>
              <td l-text="this.team[0]"></td>
              <td l-text="this.team[1]"></td>
              <td>
                <button @click="
                  const u = prompt('Enter new value');
                  if (isNaN(u)) {
                    alert('Please enter a valid number ):')
                  } else {
                    this.team[1] = u;
                    globalApp.render()
                  }">
                  Edit
                </button>
                 
                <button @click="
                const p = confirm(`Are you sure you want to remove the team, ${this.team[0]}, permanently from the session? This is  irreversabl.`e;
                if(p === true){
                  let i = leaderboard.indexOf(this.team);
                  leaderboard.splice(i, 1);
                } else {
                  alert('Alright, the removal process was cancelled.')
                }
                ">Remove</button>
              </td>
            </tr>
          </tbody>
        </table>
      </details>
      <h3>Time: <span l-text="(timer === -1) ? 'N/A' : (timer + ' s')"></span></h3>
      <details open>
        <summary>Entries</summary>
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Time</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody l-for="(entry, i) in entries">
            <tr>
              <td l-text="this.entry.teamName"></td>
              <td l-text="this.entry.date"></td>
              <td>
                <button @click="score(1, this.i)">True</button>
                <button @click="score(0, this.i)">False</button>
              </td>
            </tr>
          </tbody>
        </table>
      </details>
    </div>
    <script>
      const id = '<%= id %>';
    </script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.1.1/socket.io.js"
      integrity="sha512-oFOCo2/3DtjrJG4N27BjSLQWoiBv171sK6a+JiWjp/7agxC2nCUP358AqzxkBUb5jX8g6CYLPdSKQTbC0weCwA=="
      crossorigin="anonymous"
    ></script>
    <script src="/js/lucia.min.js"></script>
    <script src="/js/host.js"></script>
  </body>